#!/bin/bash
# TEMPLATE ONLY - DO NOT FILL IN WITH REAL VALUES
# Copy this file to a location outside the repository or to a different filename before filling in real values

# Development environment variables
# These will be set in the 'dev' GitHub environment
# Backend variables
export DEV_SQLALCHEMY_DATABASE_URL="postgresql://rhesis-user:password@/rhesis?host=/cloudsql/rhesis-dev:europe-west4:db-dev"
export DEV_SQLALCHEMY_DB_MODE="develop"
export DEV_SQLALCHEMY_DB_DRIVER="postgresql"
export DEV_SQLALCHEMY_DB_USER="rhesis-user"
export DEV_SQLALCHEMY_DB_PASS="your-db-password"
export DEV_SQLALCHEMY_DB_HOST="/cloudsql/rhesis-dev:europe-west4:db-dev"
export DEV_SQLALCHEMY_DB_NAME="rhesis"
export DEV_DB_ENCRYPTION_KEY="your-db-encryption-key"
export DEV_LOG_LEVEL="DEBUG"
export DEV_AUTH0_DOMAIN="dev-tenant.auth0.com"
export DEV_AUTH0_AUDIENCE="https://api.dev-app.rhesis.ai"
export DEV_AUTH0_CLIENT_ID="your-auth0-client-id"
export DEV_AUTH0_CLIENT_SECRET="your-auth0-client-secret"
export DEV_AUTH0_SECRET_KEY="your-auth0-secret-key"
export DEV_JWT_SECRET_KEY="your-jwt-secret-key"
export DEV_JWT_ALGORITHM="HS256"
export DEV_JWT_ACCESS_TOKEN_EXPIRE_MINUTES="10080"
export DEV_FRONTEND_URL="https://dev-app.rhesis.ai"
export DEV_GEMINI_API_KEY="your-gemini-api-key"
export DEV_GOOGLE_API_KEY="your-google-api-key"
export DEV_GEMINI_MODEL_NAME="gemini-2.0-flash-001"
export DEV_DEFAULT_GENERATION_MODEL="vertex_ai"
export DEV_DEFAULT_MODEL_NAME="gemini-2.0-flash"  # Recommended - faster than 2.5
export DEV_GOOGLE_APPLICATION_CREDENTIALS="your-base64-encoded-service-account-json"
export DEV_VERTEX_AI_LOCATION="europe-west4"  # Netherlands - best for Europe
export DEV_VERTEX_AI_PROJECT=""  # Optional: Leave empty to auto-extract from credentials
export DEV_PERSPECTIVE_API_KEY="your-perspective-api-key"
export DEV_RHESIS_BASE_URL="https://api.rhesis.ai"
export DEV_SMTP_HOST="smtp.example.com"
export DEV_SMTP_PORT="587"
export DEV_SMTP_USER="smtp-user"
export DEV_SMTP_PASSWORD="smtp-password"
export DEV_FROM_EMAIL="engineering@example.com"
export DEV_DEMO_USER_EMAIL="demo@rhesis.ai"
export DEV_DEMO_USER_PASSWORD="PlatypusDemo!"
export DEV_BACKEND_ENV="development"
export DEV_STORAGE_SERVICE_URI="gs://sources-rhesis-dev"
# Note: STORAGE_SERVICE_ACCOUNT_KEY should be Base64 encoded JSON to avoid parsing issues with commas
export DEV_STORAGE_SERVICE_ACCOUNT_KEY='your-base64-service-account-key'
export DEV_LOCAL_STORAGE_PATH="/tmp/rhesis-files"
# Celery worker variables
export DEV_BROKER_URL="rediss://:your-redis-auth-string@your-redis-host:6378/0?ssl_cert_reqs=CERT_NONE"
export DEV_CELERY_RESULT_BACKEND="rediss://:your-redis-auth-string@your-redis-host:6378/1?ssl_cert_reqs=CERT_NONE"
export DEV_CELERY_WORKER_CONCURRENCY="2"
export DEV_CELERY_WORKER_PREFETCH_MULTIPLIER="4"
export DEV_CELERY_WORKER_MAX_TASKS_PER_CHILD="1000"
export DEV_WORKER_ENV="development"
export DEV_VPC_CONNECTOR_NAME="redis-connector"
export DEV_REGION="gcp-region"
export DEV_CLOUDSQL_INSTANCE="gcp-cloud-sql-instance"
export RHESIS_CONNECTOR_DISABLED="true"

# Frontend variables
export DEV_FRONTEND_ENV="development"
export DEV_NEXTAUTH_URL="https://dev-app.rhesis.ai"
export DEV_NEXTAUTH_SECRET="your-nextauth-secret"
export DEV_NEXT_PUBLIC_API_BASE_URL="https://dev-api.rhesis.ai"
export DEV_BACKEND_URL="https://dev-api.rhesis.ai"
export DEV_AUTH_SECRET="your-auth-secret"
export DEV_GOOGLE_CLIENT_ID="your-google-client-id.apps.googleusercontent.com"
export DEV_GOOGLE_CLIENT_SECRET="your-google-client-secret"
export DEV_GH_CLIENT_ID="your-github-client-id"
export DEV_GH_CLIENT_SECRET="your-github-client-secret"
export DEV_NEXT_PUBLIC_APP_URL="https://dev-app.rhesis.ai"
export DEV_NEXT_PUBLIC_AUTH0_CLIENT_ID="your-auth0-client-id"
export DEV_NEXT_PUBLIC_AUTH0_DOMAIN="dev-tenant.auth0.com"
export DEV_DATABASE_URL="postgresql://rhesis-user:password@/rhesis?host=/cloudsql/rhesis-dev:europe-west4:db-dev"
# Polyphemus service variables
export DEV_POLYPHEMUS_REGION="gcp-region"  # GCP region for Polyphemus Cloud Run deployment
export DEV_DEFAULT_MODEL="default-model"  # Default model for Polyphemus
export DEV_MODEL_BUCKET="model-bucket-name"
export DEV_MODEL_PATH="gs://model-bucket-name/models"

# Staging environment variables
# These will be set in the 'stg' GitHub environment
# Backend variables
export STG_BACKEND_ENV="staging"
export STG_SQLALCHEMY_DATABASE_URL="postgresql://rhesis-user:password@/rhesis?host=/cloudsql/rhesis-stg:europe-west4:db-stg"
export STG_SQLALCHEMY_DB_MODE="develop"
export STG_SQLALCHEMY_DB_DRIVER="postgresql"
export STG_SQLALCHEMY_DB_USER="rhesis-user"
export STG_SQLALCHEMY_DB_PASS="your-db-password"
export STG_SQLALCHEMY_DB_HOST="/cloudsql/rhesis-stg:europe-west4:db-stg"
export STG_SQLALCHEMY_DB_NAME="rhesis"
export STG_DB_ENCRYPTION_KEY="your-db-encryption-key"
export STG_LOG_LEVEL="DEBUG"
export STG_AUTH0_DOMAIN="stg-tenant.auth0.com"
export STG_AUTH0_AUDIENCE="https://api.stg-app.rhesis.ai"
export STG_AUTH0_CLIENT_ID="your-auth0-client-id"
export STG_AUTH0_CLIENT_SECRET="your-auth0-client-secret"
export STG_AUTH0_SECRET_KEY="your-auth0-secret-key"
export STG_JWT_SECRET_KEY="your-jwt-secret-key"
export STG_JWT_ALGORITHM="HS256"
export STG_JWT_ACCESS_TOKEN_EXPIRE_MINUTES="60"
export STG_FRONTEND_URL="https://stg-app.rhesis.ai"
export STG_GEMINI_API_KEY="your-gemini-api-key"
export STG_GOOGLE_API_KEY="your-google-api-key"
export STG_GEMINI_MODEL_NAME="gemini-2.0-flash-001"
export STG_DEFAULT_GENERATION_MODEL="vertex_ai"
export STG_DEFAULT_MODEL_NAME="gemini-2.0-flash"  # Recommended - faster than 2.5
export STG_GOOGLE_APPLICATION_CREDENTIALS="your-base64-encoded-service-account-json"
export STG_VERTEX_AI_LOCATION="europe-west4"  # Netherlands - best for Europe
export STG_VERTEX_AI_PROJECT=""  # Optional: Leave empty to auto-extract from credentials
export STG_PERSPECTIVE_API_KEY="your-perspective-api-key"
export STG_RHESIS_BASE_URL="https://stg-api.rhesis.ai"
export STG_SMTP_HOST="smtp.example.com"
export STG_SMTP_PORT="587"
export STG_SMTP_USER="smtp-user"
export STG_SMTP_PASSWORD="smtp-password"
export STG_FROM_EMAIL="engineering@example.com"
export STG_DEMO_USER_EMAIL="demo@rhesis.ai"
export STG_DEMO_USER_PASSWORD="PlatypusDemo!"
export STG_STORAGE_SERVICE_URI="gs://sources-rhesis-stg"
export STG_VPC_CONNECTOR_NAME="vpc-connector-name"
export STG_REGION="gcp-region"
export STG_CLOUDSQL_INSTANCE="cloud-sql-instance-name"
export STG_RHESIS_CONNECTOR_DISABLED="true"
# Note: STORAGE_SERVICE_ACCOUNT_KEY should be Base64 encoded JSON to avoid parsing issues with commas
export STG_STORAGE_SERVICE_ACCOUNT_KEY='your-base64-service-account-key'
export STG_LOCAL_STORAGE_PATH="/tmp/rhesis-files"
# Celery worker variables
export STG_WORKER_ENV="staging"
export STG_BROKER_URL="rediss://:your-redis-auth-string@your-redis-host:6378/0?ssl_cert_reqs=CERT_NONE"
export STG_CELERY_RESULT_BACKEND="rediss://:your-redis-auth-string@your-redis-host:6378/1?ssl_cert_reqs=CERT_NONE"
export STG_CELERY_WORKER_CONCURRENCY="2"
export STG_CELERY_WORKER_PREFETCH_MULTIPLIER="4"
export STG_CELERY_WORKER_MAX_TASKS_PER_CHILD="1000"

# Frontend variables
export STG_FRONTEND_ENV="staging"
export STG_NEXTAUTH_URL="https://stg-app.rhesis.ai"
export STG_NEXTAUTH_SECRET="your-nextauth-secret"
export STG_NEXT_PUBLIC_API_BASE_URL="https://stg-api.rhesis.ai"
export STG_BACKEND_URL="https://stg-api.rhesis.ai"
export STG_AUTH_SECRET="your-auth-secret"
export STG_GOOGLE_CLIENT_ID="your-google-client-id.apps.googleusercontent.com"
export STG_GOOGLE_CLIENT_SECRET="your-google-client-secret"
export STG_GH_CLIENT_ID="your-github-client-id"
export STG_GH_CLIENT_SECRET="your-github-client-secret"
export STG_NEXT_PUBLIC_APP_URL="https://stg-app.rhesis.ai"
export STG_NEXT_PUBLIC_AUTH0_CLIENT_ID="your-auth0-client-id"
export STG_NEXT_PUBLIC_AUTH0_DOMAIN="stg-tenant.auth0.com"
export STG_DATABASE_URL="postgresql://rhesis-user:password@/rhesis?host=/cloudsql/rhesis-stg:europe-west4:db-stg"
# Polyphemus service variables
export STG_POLYPHEMUS_REGION="gcp-region"  # GCP region for Polyphemus Cloud Run deployment
export STG_DEFAULT_MODEL="default-model"  # Default model for Polyphemus
export STG_MODEL_BUCKET="model-bucket-name"
export STG_MODEL_PATH="gs://model-bucket-name/models"

# Production environment variables
# These will be set in the 'prd' GitHub environment
# Backend variables
export PRD_BACKEND_ENV="production"
export PRD_SQLALCHEMY_DATABASE_URL="postgresql://rhesis-user:password@/rhesis?host=/cloudsql/rhesis-prd:europe-west4:db-prd"
export PRD_SQLALCHEMY_DB_MODE="production"
export PRD_SQLALCHEMY_DB_DRIVER="postgresql"
export PRD_SQLALCHEMY_DB_USER="rhesis-user"
export PRD_SQLALCHEMY_DB_PASS="your-db-password"
export PRD_SQLALCHEMY_DB_HOST="/cloudsql/rhesis-prd:europe-west4:db-prd"
export PRD_SQLALCHEMY_DB_NAME="rhesis"
export PRD_DB_ENCRYPTION_KEY="your-db-encryption-key"
export PRD_LOG_LEVEL="INFO"
export PRD_AUTH0_DOMAIN="tenant.auth0.com"
export PRD_AUTH0_AUDIENCE="https://api.app.rhesis.ai"
export PRD_AUTH0_CLIENT_ID="your-auth0-client-id"
export PRD_AUTH0_CLIENT_SECRET="your-auth0-client-secret"
export PRD_AUTH0_SECRET_KEY="your-auth0-secret-key"
export PRD_JWT_SECRET_KEY="your-jwt-secret-key"
export PRD_JWT_ALGORITHM="HS256"
export PRD_JWT_ACCESS_TOKEN_EXPIRE_MINUTES="30"
export PRD_FRONTEND_URL="https://app.rhesis.ai"
export PRD_GEMINI_API_KEY="your-gemini-api-key"
export PRD_GOOGLE_API_KEY="your-google-api-key"
export PRD_GEMINI_MODEL_NAME="gemini-2.0-flash-001"
export PRD_DEFAULT_GENERATION_MODEL="vertex_ai"
export PRD_DEFAULT_MODEL_NAME="gemini-2.0-flash"  # Recommended - faster than 2.5
export PRD_GOOGLE_APPLICATION_CREDENTIALS="your-base64-encoded-service-account-json"
export PRD_VERTEX_AI_LOCATION="europe-west4"  # Netherlands - best for Europe
export PRD_VERTEX_AI_PROJECT=""  # Optional: Leave empty to auto-extract from credentials
export PRD_PERSPECTIVE_API_KEY="your-perspective-api-key"
export PRD_RHESIS_BASE_URL="https://api.rhesis.ai"
export PRD_SMTP_HOST="smtp.example.com"
export PRD_SMTP_PORT="587"
export PRD_SMTP_USER="smtp-user"
export PRD_SMTP_PASSWORD="smtp-password"
export PRD_FROM_EMAIL="engineering@example.com"
export PRD_DEMO_USER_EMAIL="demo@rhesis.ai"
export PRD_DEMO_USER_PASSWORD="PlatypusDemo!"
export PRD_STORAGE_SERVICE_URI="gs://sources-rhesis-prd"
export PRD_VPC_CONNECTOR_NAME="vpc-connector-name"
export PRD_REGION="gcp-region"
export PRD_CLOUDSQL_INSTANCE="cloud-sql-instance-name"
export PRD_RHESIS_CONNECTOR_DISABLED="true"
# Note: STORAGE_SERVICE_ACCOUNT_KEY should be Base64 encoded JSON to avoid parsing issues with commas
export PRD_STORAGE_SERVICE_ACCOUNT_KEY='your-base64-service-account-key'
export PRD_LOCAL_STORAGE_PATH="/tmp/rhesis-files"
# Celery worker variables
export PRD_WORKER_ENV="production"
export PRD_BROKER_URL="rediss://:your-redis-auth-string@your-redis-host:6378/0?ssl_cert_reqs=CERT_NONE"
export PRD_CELERY_RESULT_BACKEND="rediss://:your-redis-auth-string@your-redis-host:6378/1?ssl_cert_reqs=CERT_NONE"
export PRD_CELERY_WORKER_CONCURRENCY="2"
export PRD_CELERY_WORKER_PREFETCH_MULTIPLIER="4"
export PRD_CELERY_WORKER_MAX_TASKS_PER_CHILD="1000"

# Frontend variables
export PRD_FRONTEND_ENV="production"
export PRD_NEXTAUTH_URL="https://app.rhesis.ai"
export PRD_NEXTAUTH_SECRET="your-nextauth-secret"
export PRD_NEXT_PUBLIC_API_BASE_URL="https://api.rhesis.ai"
export PRD_BACKEND_URL="https://api.rhesis.ai"
export PRD_AUTH_SECRET="your-auth-secret"
export PRD_GOOGLE_CLIENT_ID="your-google-client-id.apps.googleusercontent.com"
export PRD_GOOGLE_CLIENT_SECRET="your-google-client-secret"
export PRD_GH_CLIENT_ID="your-github-client-id"
export PRD_GH_CLIENT_SECRET="your-github-client-secret"
export PRD_NEXT_PUBLIC_APP_URL="https://app.rhesis.ai"
export PRD_NEXT_PUBLIC_AUTH0_CLIENT_ID="your-auth0-client-id"
export PRD_NEXT_PUBLIC_AUTH0_DOMAIN="tenant.auth0.com"
export PRD_DATABASE_URL="postgresql://rhesis-user:password@/rhesis?host=/cloudsql/rhesis-prd:europe-west4:db-prd"
# Polyphemus service variables
export PRD_POLYPHEMUS_REGION="gcp-region"  # GCP region for Polyphemus Cloud Run deployment
export PRD_DEFAULT_MODEL="default-model"  # Default model for Polyphemus
export PRD_MODEL_BUCKET="model-bucket-name"
export PRD_MODEL_PATH="gs://model-bucket-name/models"

# Test environment variables (for GitHub Actions testing)
# These will be set as environment-specific secrets in the 'test' environment
export TEST_SQLALCHEMY_DB_MODE="test"
export TEST_SQLALCHEMY_DB_DRIVER="postgresql"
export TEST_SQLALCHEMY_DB_USER="rhesis-user"
export TEST_SQLALCHEMY_DB_PASS="test_password_123"
export TEST_SQLALCHEMY_DB_HOST="localhost"
export TEST_SQLALCHEMY_DB_NAME="rhesis-test"
export TEST_LOG_LEVEL="WARNING"
export TEST_AUTH0_DOMAIN="dev-tenant.auth0.com"
export TEST_AUTH0_AUDIENCE="https://api.dev-app.rhesis.ai"
export TEST_AUTH0_CLIENT_ID="your-auth0-client-id"
export TEST_AUTH0_CLIENT_SECRET="your-auth0-client-secret"
export TEST_AUTH0_SECRET_KEY="your-auth0-secret-key"
export TEST_JWT_SECRET_KEY="your-jwt-secret-key"
export TEST_JWT_ALGORITHM="HS256"
export TEST_JWT_ACCESS_TOKEN_EXPIRE_MINUTES="10080"
export TEST_FRONTEND_URL="http://localhost:3000"
export TEST_GEMINI_API_KEY="your-gemini-api-key"
export TEST_GEMINI_MODEL_NAME="gemini-2.0-flash-001"
export TEST_DEFAULT_GENERATION_MODEL="vertex_ai"
export TEST_DEFAULT_MODEL_NAME="gemini-2.0-flash"  # Recommended - faster than 2.5
export TEST_GOOGLE_APPLICATION_CREDENTIALS="your-base64-encoded-service-account-json"
export TEST_VERTEX_AI_LOCATION="europe-west4"  # Netherlands - best for Europe
export TEST_VERTEX_AI_PROJECT=""  # Optional: Leave empty to auto-extract from credentials
export TEST_PERSPECTIVE_API_KEY="your-perspective-api-key"
export TEST_SMTP_HOST="smtp.example.com"
export TEST_SMTP_PORT="587"
export TEST_SMTP_USER="smtp-user"
export TEST_SMTP_PASSWORD="smtp-password"
export TEST_FROM_EMAIL="engineering@example.com"
export TEST_DEMO_USER_EMAIL="demo@rhesis.ai"
export TEST_DEMO_USER_PASSWORD="PlatypusDemo!"
export TEST_STORAGE_SERVICE_URI="gs://sources-rhesis-test"
# Note: STORAGE_SERVICE_ACCOUNT_KEY should be Base64 encoded JSON to avoid parsing issues with commas
export TEST_STORAGE_SERVICE_ACCOUNT_KEY='your-base64-service-account-key'
export TEST_LOCAL_STORAGE_PATH="/tmp/rhesis-files"
export TEST_REDIS_URL="redis://localhost:6379"
export TEST_BROKER_URL="redis://localhost:6379/0"
export TEST_CELERY_RESULT_BACKEND="redis://localhost:6379/0"
# Polyphemus service variables
export TEST_POLYPHEMUS_REGION="gcp-region"  # GCP region for Polyphemus Cloud Run deployment
export TEST_DEFAULT_MODEL="default-model"  # Default model for Polyphemus

# Get the GitHub repository from the current directory or specify it manually
REPO=$(gh repo view --json nameWithOwner -q .nameWithOwner 2>/dev/null || echo "")

if [[ -z "$REPO" ]]; then
  # If automatic detection fails, specify your repository manually
  REPO="your-org/your-repo"
fi

# Run the setup script
./service-secrets-create.sh --repo "$REPO"
