import { CodeBlock } from '@/components/CodeBlock'

# Entities

Entities are the SDK's interface to the Rhesis platform. They provide typed Python objects that map directly to platform resources, enabling you to create, read, update, and delete data programmatically. Entities are used throughout the SDKâ€”for example, synthesizers generate a `TestSet` entity that contains multiple `Test` entities.

<Callout type="info">
  **Prerequisites**: To work with entities from [app.rhesis.ai](https://app.rhesis.ai), ensure you have [configured the SDK](/sdk/installation) with your API key.
</Callout>

## Available Entities

| Entity | Description |
|--------|-------------|
| [Behavior](/sdk/entities/taxonomies#behavior) | Expected behaviors with associated metrics |
| [Category](/sdk/entities/taxonomies#category) | Test categorization |
| [Topic](/sdk/entities/taxonomies#topic) | Subject matter classification |
| [Status](/sdk/entities/taxonomies#status) | Entity state tracking |
| [Test](/sdk/entities/test-sets#test) | Individual test cases with prompts |
| [TestSet](/sdk/entities/test-sets#testset) | Collections of tests for evaluation |
| [TestRun](/sdk/entities/test-runs#testrun) | Execution records for test batches |
| [TestResult](/sdk/entities/test-runs#testresult) | Individual test execution results |
| [TestConfiguration](/sdk/entities/test-runs#testconfiguration) | Settings for test execution |
| [Endpoint](/sdk/entities/endpoints) | AI services to test against |

## Entity vs Collection Classes

The SDK uses two class patterns:

- **Entity classes** (`TestSet`, `Test`, `Endpoint`): Represent single records. Use for creating, updating, and deleting individual items.
- **Collection classes** (`TestSets`, `Tests`, `Endpoints`): Provide query methods. Use for fetching and searching records.

<CodeBlock filename="entity_vs_collection.py" language="python">
{`from rhesis.sdk.entities import TestSet, TestSets

# Collection: query operations
all_sets = TestSets.all()                    # Get all
one_set = TestSets.pull(id="abc123")         # Get by ID
exists = TestSets.exists("abc123")           # Check existence

# Entity: instance operations
test_set = TestSet(name="New Set", ...)      # Create new
test_set.push()                              # Save to platform
test_set.pull()                              # Refresh from platform
test_set.delete()                            # Remove from platform`}
</CodeBlock>

## Common Operations

All entities share a consistent interface for CRUD operations. Each entity class has a corresponding collection class (e.g., `TestSet` and `TestSets`) for querying multiple records.

### Fetching Entities

Retrieve entities from the platform using the collection class:

<CodeBlock filename="fetch_entities.py" language="python">
{`from rhesis.sdk.entities import TestSets, TestSet

# Get all test sets
all_test_sets = TestSets.all()
for ts in all_test_sets:
    print(f"{ts.name}: {ts.test_count} tests")

# Get by ID
test_set = TestSets.pull(id="abc123")

# Get by name (case-insensitive)
test_set = TestSets.pull(name="My Test Set")

# Get first record
first = TestSets.first()`}
</CodeBlock>

### Filtering Results

Use OData filter syntax to query specific records:

<CodeBlock filename="filter_entities.py" language="python">
{`from rhesis.sdk.entities import TestSets, Tests

# Filter test sets by name pattern
test_sets = TestSets.all(filter="contains(tolower(name), 'safety')")

# Filter tests by category
tests = Tests.all(filter="category eq 'security'")`}
</CodeBlock>

### Creating Entities

Create new entities locally and save them to the platform with `push()`:

<CodeBlock filename="create_entity.py" language="python">
{`from rhesis.sdk.entities import Category

category = Category(
    name="Safety",
    description="Tests for safety-critical behaviors"
)

# Save to platform
category.push()
print(f"Created with ID: {category.id}")`}
</CodeBlock>

### Updating Entities

Modify entity attributes and call `push()` to save changes:

<CodeBlock filename="update_entity.py" language="python">
{`from rhesis.sdk.entities import Categories

# Fetch existing entity
category = Categories.pull(name="Safety")

# Modify and save
category.description = "Updated description for safety tests"
category.push()`}
</CodeBlock>

### Refreshing from Platform

Use `pull()` on an instance to refresh its data from the platform:

<CodeBlock filename="refresh_entity.py" language="python">
{`from rhesis.sdk.entities import TestSets

test_set = TestSets.pull(id="abc123")

# ... time passes, data may have changed on platform ...

# Refresh from platform
test_set.pull()
print(f"Updated test count: {test_set.test_count}")`}
</CodeBlock>

### Deleting Entities

Remove entities from the platform:

<CodeBlock filename="delete_entity.py" language="python">
{`from rhesis.sdk.entities import Categories

category = Categories.pull(name="Deprecated Category")
deleted = category.delete()

if deleted:
    print("Category removed")`}
</CodeBlock>

### Checking Existence

Verify if an entity exists without fetching full data:

<CodeBlock filename="check_exists.py" language="python">
{`from rhesis.sdk.entities import TestSets

if TestSets.exists("abc123"):
    test_set = TestSets.pull(id="abc123")
else:
    print("Test set not found")`}
</CodeBlock>

## Data Export

Entities support conversion to dictionaries and CSV files:

<CodeBlock filename="export_data.py" language="python">
{`from rhesis.sdk.entities import Categories

category = Categories.pull(name="Safety")

# Convert to dictionary
data = category.to_dict()
print(data)

# Export to CSV
category.to_csv("category.csv")`}
</CodeBlock>

---

<Callout type="default">
  **Next Steps** - Create and manage [Test Sets](/sdk/entities/test-sets) for evaluation
  - Configure [Endpoints](/sdk/entities/endpoints) to test your AI services
  - Track execution with [Test Runs](/sdk/entities/test-runs)
</Callout>
